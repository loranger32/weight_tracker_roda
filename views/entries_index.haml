- @page_title = 'Entries'

%h2.text-center.mb-4 Progress

.row
  .col-10.offset-1.col-sm-8.offset-sm-2.col-md-6.offset-md-3.col-lg-4.offset-lg-4
    - if @all_batches
      .alert.alert-info.w-75.mx-auto.text-center.mb-5
        %a.d-block.no-decoration.mb-2{href: "/batches"} All batches
        %a.d-block.rounded.no-decoration.bg-warning.text-white.w-50.mx-auto.mb-1{href: "/entries"}
          %small See Current
    -else
      .alert.alert-info.w-75.mx-auto.text-center.mb-2
        %a.d-block.no-decoration.mb-2{href: "/batches"}
          = @batch_info[:name]
          %br
          Target: #{@batch_info[:target]}

        %a.d-block.rounded.no-decoration.bg-warning.text-white.w-50.mx-auto.mb-1{href: "/entries?all_batches=true"}
          %small See All
      %a.d-block.btn.btn-primary.w-75.mx-auto.mb-5{href: "/entries/new"} New Entry

.row
  .col-12.col-md-10.offset-md-1.col-lg-5.mb-5
    %p#chart-entries!= @chart_data.to_json
    .row.mb-3
      .col-6
        %button.btn.btn-primary#line_display_button{type: "button"} Line
        %button.btn.btn-primary#bar_display_button{type: "button"} Bar
      .col-5
        %select.form-select#select_day_of_week{aria_label: "Select day of week"}
          %option{selected: true, value: 7} Show all days
          %option{value: 1} Monday
          %option{value: 2} Tuesday
          %option{value: 3} Wednesday
          %option{value: 4} Thursday
          %option{value: 5} Friday
          %option{value: 6} Saturday
          %option{value: 0} Sunday
    %canvas#myChart{width: 100, height: 100}
  .col-12.col-md-10.offset-md-1.col-lg-5
    - if @entries.empty?
      %p.text-center No entries in this batch yet
    - else
      %table.table.table-hover.table-borderless
        %thead.table-light
          %td.text-center DAY
          %td.text-center WEIGHT
          %td.text-center + / -
          - unless @all_batches
            %td.text-center LEFT
          %td.text-center BMI
        %tbody
          - @entries.each do |entry|
            %tr{class: entry_highlight?(entry.day) ? "bg-gainsboro" : "bg-body"}
              %td.text-center
                %a.no-decoration{href: "/entries/#{entry.id}/edit", "data-bs-toggle" => "tooltip",
                "data-bs-placement" => "bottom", title: entry.note}&= entry.day.strftime("%a %d %b %Y")
              %td.text-center= entry.weight.to_f
              %td.text-center{class: weight_delta_color(entry.delta)}&= format_delta(entry.delta)
              - unless @all_batches
                %td.text-center= @batch_info[:target] ? entry.delta_to_target : "/"
              %td.text-center= entry.bmi

- content_for :js, assets([:js, :bs_tooltip])
- content_for :js, assets([:js, :chartjs_min])
- content_for :js, assets([:js, :chartjs_adapter])
- content_for :js, assets([:js, :entries_index_charts])
